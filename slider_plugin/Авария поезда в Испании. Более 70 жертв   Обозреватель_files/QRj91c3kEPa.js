/*!CK:153383244!*//*1375796946,178191165*/

if (self.CavalryLogger) { CavalryLogger.start_js(["OFYQ5"]); }

__d("ComposerPublishTrackingStory",["Event","ge","reportData","DOMQuery"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ge'),i=b('reportData'),j=b('DOMQuery');f.init=function(k){g.listen(k,'submit',function(){var l=h('home_stream');if(!l)return;var m=j.scry(l,'.uiStreamStory')[0];if(m&&m.getAttribute('data-ft')){var n=JSON.parse(m.getAttribute('data-ft'));if(!(("mf_story_key" in n)&&("qid" in n)))return;var o={mf_story_key:n.mf_story_key,qid:n.qid};i("compose",{ft:o});}});};});
__d("ComposerXAttachmentUtils",["CSS","DataStore","DOMQuery","Focus","Input","PageTransitions","Run","StickyPlaceholderInput","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOMQuery'),j=b('Focus'),k=b('Input'),l=b('PageTransitions'),m=b('Run'),n=b('StickyPlaceholderInput'),o=b('tx'),p='composer_fixed_placeholder';function q(s,t){if(!h.get(s.element,p,false))s.instance.setPlaceholder(t);}var r={initMentions:function(s,t){q(s,t);var u=i.find(s.element,'textarea.input');j.set(u);},setStickyPlaceholderForMentions:function(s,t){if(i.contains(s.element,document.activeElement)&&g.hasClass(document.activeElement,'DOMControl_placeholder'))document.activeElement.blur();q(s,t);},setPlaceholderIsFixed:function(s,t){h.set(s.element,p,!!t);},setStickyPlaceholderForTypeahead:function(s,t){var u=i.find(s,'.textInput');n.setPlaceholderText(u,t);},registerInputForLeaveWarning:function(s){m.onBeforeUnload(function(){var t=l.getNextURI();if(t.getQueryData().hasOwnProperty('theater'))return;if(a.Dialog&&a.Dialog.getCurrent())return;if(s.offsetParent!==null&&!k.isEmpty(s))return "\u0425\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u043d\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0432 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044e?";});}};e.exports=r;});
__d("ComposerXBootloadStatusAttachment",["Event","function-extensions","Arbiter","AsyncRequest","Bootloader","Class","ComposerXAttachment","ComposerXController","ComposerXDragDrop","ComposerXStore","CSS","DOM","DOMQuery","Focus","Parent","PlaceholderListener","PrivacyConst","URI","SelectorDeprecated","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Arbiter'),i=b('AsyncRequest'),j=b('Bootloader'),k=b('Class'),l=b('ComposerXAttachment'),m=b('ComposerXController'),n=b('ComposerXDragDrop'),o=b('ComposerXStore'),p=b('CSS'),q=b('DOM'),r=b('DOMQuery'),s=b('Focus'),t=b('Parent'),u=b('PlaceholderListener'),v=b('PrivacyConst'),w=b('URI'),x=b('SelectorDeprecated'),y=b('copyProperties'),z=b('csx'),aa=b('cx'),ba={};function ca(da,ea){this.parent.construct(this);this._root=da;this._config=ea;}k.extend(ca,l);y(ca.prototype,{_attachmentIsActive:false,_bootloading:false,_fullVersion:false,_focusListener:null,_privacyWidgetTags:null,_scraper:null,_dragdrop:null,attachmentClassName:"_4j",getRoot:function(){return this._root;},initWithComponents:function(da){ba[this._composerID]=this;this._attachmentIsActive=true;var ea=r.find(this.getComponent('maininput').element,'textarea.input'),fa=r.find(t.byClass(this.getRoot(),"_119"),'li.'+this.attachmentClassName);if(this._fullVersion){this._fullInitWithComponents();}else if(!this._bootloading)if(r.contains(this._root,document.activeElement)){this._onInitialFocus();}else{this._focusListener=g.listen(ea,'focus',this._onInitialFocus.bind(this));this._clickListener=g.listen(fa,'click',function(){s.set(ea);}.bind(this));}this._dragEnterHandler=h.subscribe('dragenter',function(ga,ha){if(ha.element==this._root){var ia=ha.event.dataTransfer.items,ja;if(ia)ja=n.filterImages(ia);if(ja&&ja.length>0){s.set(ea);}else{var ka=t.byClass(this._root,'focus_target');u.expandInput(ka);if(!this._bootloading&&!this._fullVersion)this._onInitialFocus();}}}.bind(this));this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);if(!da)s.set(ea);if(this._config.plus_version){this._dragdrop=new n(this._root,this._composerID,this._config.targetID);this._dragdrop.enableURLDropping();}},_fullInitWithComponents:function(){j.loadModules(['ComposerXPrivacyWidgetTags','URLScraper','URI'],function(da,ea,fa){this._tagger.init(this);this._privacyWidgetTags=new da(this);var ga=r.find(this.getComponent('maininput').element,'textarea.input');if(!this._scraper){this._scraper=new ea(ga);this._scraper.subscribe('match',function(ha,ia){var ja=this._getScraperEndpoint();ja.addQueryData({scrape_url:encodeURIComponent(ia.url)});m.getAttachment(this._root,ja.toString());}.bind(this));}this._scraper.enable();this._scraper.check();}.bind(this));this._initPrivacyReminder();},_initPrivacyReminder:function(){if(!this._reminderDialog||this._reminderShown)return;var da=this.getComponent('mainprivacywidget').element,ea=x.getValue(da);if(ea!==String(v.BaseValue.SELF))return;this._reminderDialog.setContext(this.getComponent('mainprivacywidget').element).show();this._reminderShown=true;new i('/ajax/privacy/reminders/log_imp').setData({type:'only_me'}).send();var fa=function(){new i('/ajax/privacy/reminders/dismiss').setData({type:'only_me'}).send();this._reminderDialog.hide();}.bind(this);this._conversionListener=x.subscribe('select',function(ga,ha){if(ha.selector==da.firstChild){var ia=x.getValue(ha.option);if(ia!==String(v.BaseValue.SELF)){new i('/ajax/privacy/reminders/log_imp').setData({type:'only_me_conversion'}).send();x.unsubscribe(this._conversionListener);}}}.bind(this));this._reminderEvents=[g.listen(this._reminderDialog.getContent(),'click',fa),g.listen(this._reminderDialog.getContext(),'click',fa)];},cleanup:function(){this._attachmentIsActive=false;if(this._focusListener){this._focusListener.remove();this._focusListener=null;}if(this._clickListener){this._clickListener.remove();this._clickListener=null;}if(this._reminderDialog&&this._reminderShown){this._reminderDialog.hide();this._reminderEvents.forEach(function(da){da.remove();});this._conversionListener&&x.unsubscribe(this._conversionListener);}if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}if(this._fullVersion){this._tagger.cleanup();this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._scraper.disable();}if(this._dragEnterHandler){this._dragEnterHandler.unsubscribe();this._dragEnterHandler=null;}},reset:function(){var da=t.byClass(this._root,"child_was_focused");if(da)p.removeClass(da,"child_was_focused");if(this._tagger)this._tagger.reset();this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);},canSwitchAway:function(){return !t.byClass(this._root,'async_saving');},setBootloadedContent:function(da,ea,fa,ga){this._reminderDialog=ga;var ha=fa.map(function(ia){return ia.component_name;});o.waitForComponents(this._composerID,ha,function(){var ia=r.find(this._root,"._3-6"),ja=r.find(this._root,"._3-7");q.setContent(ia,da.tagger_content);q.setContent(ja,da.tagger_icons);m.addPlaceholders(this._root,this,fa);this._tagger=ea;this._fullVersion=true;if(this._attachmentIsActive){if(this._focusListener){this._focusListener.remove();this._focusListener=null;}this._fullInitWithComponents();}}.bind(this));},_getScraperEndpoint:function(){return w('/ajax/composerx/attachment/link/scraper/');},_onInitialFocus:function(){h.inform('composer/focus');m.getEndpoint(this._root,'/ajax/composerx/attachment/status/bootload/',true);this._bootloading=true;},allowOGTagPreview:function(){return true;}});ca.setBootloadedContent=function(da,ea,fa,ga,ha){var ia=ba[da];if(ia)ia.setBootloadedContent(ea,fa,ga,ha);};e.exports=ca;});
__d("ComposerXMentionsInputReset",["DOMQuery","Input"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h=b('Input');function i(j){var k=g.scry(j.element,'textarea.input')[0];j.instance.reset();h.reset(k);}e.exports=i;});
__d("ComposerXOGTaggerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_4-jh");g.removeClass(j.element,"_509o");}e.exports=i;});
__d("ComposerXPrivacyWidgetReset",["Arbiter"],function(a,b,c,d,e,f){var g=b('Arbiter');function h(i){g.inform('Composer/changedtags',{withTags:[],mention:{},eventTag:false});}e.exports=h;});
__d("ComposerXTaggerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_1dsa");g.removeClass(j.element,"_1dsb");g.removeClass(j.element,"_509o");}e.exports=i;});
__d("BasePrivacyOption",["Arbiter","AudienceSelectorTags","CSS","DOM","Env","Parent","PrivacyConst","SelectorDeprecated","copyProperties","fbt","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AudienceSelectorTags'),i=b('CSS'),j=b('DOM'),k=b('Env'),l=b('Parent'),m=b('PrivacyConst'),n=b('SelectorDeprecated'),o=b('copyProperties'),p=b('fbt'),q=b('tx');function r(s,t){this._selector=l.byClass(s,'audienceSelector');this._plusLabel=j.scry(s,'.plusLabel')[0];this._audienceCountLabel=j.scry(s,'.audienceCountLabel')[0];if(!this._selector)return;this._elem=s;this._taggedIDs=[];this._tags=[];this._hasEvent=false;this._audienceCount=t||"";this._recalculateTooltipAndLabel();this._updateSelector();g.subscribe('Composer/changedtags',function(u,v){var w=i.hasClass(this._selector,'composerAudienceSelector');if(!this._getChangedData()||!w)return;var x=this._hasEvent;this._hasEvent=!!v.eventTag;this._tags=v.withTags.map(function(aa){return aa.getText();});this._taggedIDs=v.withTags.map(function(aa){return aa.getValue();});for(var y in v.mention)if(v.mention[y].type=='user'&&v.mention[y].uid!=k.user){this._tags.push(v.mention[y].text);this._taggedIDs.push(v.mention[y].uid);}else if(v.mention[y].type=='event')this._hasEvent=true;if(this._hasEvent&&x!=this._hasEvent)this._eventTagChanged();var z=this._recalculateTooltipAndLabel();if(z&&n.isOptionSelected(this._elem)){this._updateSelector();g.inform('SelectedPrivacyOption/changed',this._getChangedData());}}.bind(this));n.listen(this._selector,'change',this._updateSelector.bind(this));}o(r.prototype,{_eventTagChanged:function(){},_getChangedData:function(){return null;},_recalculateTooltipAndLabel:function(){var s=this._tooltip,t=this._label,u=this._getIncludedAudience(),v=this._getExcludedAudience(),w=this._getTagExpansionText();if(w)u=p._("{list of people who can see this}, {list of additional people who can see this}",[p.param("list of people who can see this",u),p.param("list of additional people who can see this",w)]);this._tooltip=this._getCombinedSentence(u,v);this._recalcLabel();return (s!=this._tooltip)||(t!=this._label);},_getIncludedAudience:function(){return this._elem.getAttribute('data-label');},_getExcludedAudience:function(){return '';},_getTagExpansionText:function(){var s=this._getTagExpansionBehavior();if(!!this._taggedIDs.length||this._alreadyHasTags()){if(s==m.TagExpansion.FRIENDS_OF_TAGGEES){if(this._hasEvent)return "\u0434\u0440\u0443\u0437\u044c\u044f \u0432\u0441\u0435\u0445 \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u043b\u044e\u0434\u0435\u0439, \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f";return "\u0434\u0440\u0443\u0437\u044c\u044f \u0432\u0441\u0435\u0445, \u043a\u0442\u043e \u0431\u044b\u043b \u043e\u0442\u043c\u0435\u0447\u0435\u043d";}else if(s==m.TagExpansion.TAGGEES)return "\u0412\u0441\u0435, \u043a\u0442\u043e \u0431\u044b\u043b \u043e\u0442\u043c\u0435\u0447\u0435\u043d";return '';}if(this._hasEvent&&s==m.TagExpansion.FRIENDS_OF_TAGGEES)return "\u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f";return '';},_getCombinedSentence:function(s,t){if(!t)return s;return p._("{list of people who can see this}; \u0417\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c: {list of people who cannot see this}",[p.param("list of people who can see this",s),p.param("list of people who cannot see this",t)]);},_recalcLabel:function(){this._label=this._elem.getAttribute('data-label');this._label=this._label.replace(/\(.*\)/,"");if(this._showPlusLabel()){this._label+=' (+)';}else if(this._showAudienceCount()){var s=' ('+this._audienceCount+')';this._label+=s;j.setContent(this._audienceCountLabel,s);}i.conditionShow(this._plusLabel,this._showPlusLabel());if(this._audienceCountLabel)i.conditionShow(this._audienceCountLabel,this._showAudienceCount());},_showAudienceCount:function(){return (this._audienceCountLabel&&!this._showPlusLabel()&&this._audienceCount.length>0);},_showPlusLabel:function(){var s=this._getTagExpansionBehavior(),t=!!this._taggedIDs.length||this._alreadyHasTags();return (t&&s!=m.TagExpansion.NONE)||(!!this._hasEvent&&s==m.TagExpansion.FRIENDS_OF_TAGGEES);},_getTagExpansionBehavior:function(){return m.TagExpansion.NONE;},_isSharedAlbum:function(){var s=j.scry(this._selector,'*[data-shared-album]')[0];return s&&s.getAttribute('data-shared-album');},_alreadyHasTags:function(){var s=j.scry(this._selector,'*[data-oid]')[0];s=s&&s.getAttribute('data-oid');return s&&h.hasTags(s);},_updateSelector:function(){if(n.isOptionSelected(this._elem)){var s=i.hasClass(this._selector,'composerAudienceSelector');s&&n.setButtonLabel(this._selector,this._label);n.setButtonTooltip(this._selector,this._tooltip);return false;}return true;}});e.exports=r;});
__d("CustomPrivacyOption",["Arbiter","AsyncDialog","AsyncRequest","BasePrivacyOption","DOM","Event","Form","PrivacyConst","SelectorDeprecated","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncDialog'),i=b('AsyncRequest'),j=b('BasePrivacyOption'),k=b('DOM'),l=b('Event'),m=b('Form'),n=b('PrivacyConst'),o=b('SelectorDeprecated'),p=b('copyProperties');for(var q in j)if(j.hasOwnProperty(q)&&q!=="_metaprototype")s[q]=j[q];var r=j===null?null:j.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=j;function s(t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){if(!t)return;this._baseAudienceValue=ba;this._includedAudience=ca;this._excludedAudience=da;this._tagExpansionBehavior=ea;(function(){this.initCustomState(t,u,v);l.listen(t,'click',function(event){this.openCustomDialog(event,u,w,y,z,aa);}.bind(this));o.listen(this._selector,'select',function(ga){if(ga.option._id!=this._id)this.clearCustomState();}.bind(this));j.call(this,t,fa);}).bind(this).defer();}s.prototype._getChangedData=function(){return {hasEvent:this._hasEvent,tags:this._taggedIDs,privacy:this._baseAudienceValue};};s.prototype._updateOptionValues=function(t,u,v,w,x){this._baseAudienceValue=t;this._includedAudience=u;this._excludedAudience=v;this._tagExpansionBehavior=w;this._audienceCount=x;return this;};s.prototype._updateOption=function(t){var u=o.getOption(this._selector,t)||o.getOption(this._selector,n.BaseValue.CUSTOM+'');this._recalculateTooltipAndLabel();g.inform('CustomPrivacyOption/update',{selector:this._selector,option:u,tooltip:this._tooltip,label:this._label});return this;};s.prototype._getIncludedAudience=function(){return this._includedAudience;};s.prototype._getExcludedAudience=function(){return this._excludedAudience;};s.prototype._getTagExpansionBehavior=function(){return this._tagExpansionBehavior;};s.prototype._update=function(t,u){var v=u==n.BaseValue.CUSTOM||!o.getOption(this._selector,u),w=this._selector.getAttribute('data-name');this.updateCustomState(t,v,w);return this;};s.prototype.initCustomState=function(t,u,v){s._instances[u]=this;this._container=k.find(t,'.customPrivacyInputs');this._id=v;this._privacyData={};var w=m.serialize(this._container);if(w.audience)this._privacyData=w.audience[v];return t;};s.prototype.openCustomDialog=function(event,t,u,v,w,x){var y=new i('/ajax/privacy/custom_dialog/').setData({option_id:t,id:this._id,privacy_data:this._privacyData,explain_tags:u,autosave:v,limit_to_friends:w,source:x});y.setRelativeTo(event.getTarget());h.send(y);};s.prototype.updateCustomState=function(t,u,v){this.clearCustomState();this._privacyData=p({},t);if(u)if(v){v=v.slice(0,-'[value]'.length);var w={};w[v]=t;m.createHiddenInputs(w,this._container,null,true);}};s.prototype.clearCustomState=function(){this._privacyData={};k.empty(this._container);};s.update=function(t,u,v,w,x,y,z,aa,ba){var ca=s._instances[t];ca._update(u,v)._updateOptionValues(x,y,z,aa,ba)._updateOption(v);g.inform('Form/change',{node:ca._container});};s.getData=function(t){return s._instances[t]._privacyData;};s.setPrivacyData=function(t,u,v){s._instances[t]._update(u,v);};p(s,{_instances:{}});e.exports=s;});
__d("DynamicIconSelector",["Button","CSS","DOM","SelectorDeprecated"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('SelectorDeprecated'),k={swapIcon:function(l){var m=j.getSelectedOptions(l)[0],n=m&&i.scry(m,'.itemIcon')[0],o=j.getSelectorButton(l);if(n){g.setIcon(o,n.cloneNode(true));}else{var p=i.scry(o,'.img')[0];p&&i.remove(p);}h.conditionClass(o,'uiSelectorChevronOnly',!n);}};j.subscribe('change',function(l,m){var n=m.selector;if(h.hasClass(n,'dynamicIconSelector'))k.swapIcon(n);});e.exports=k;});
__d("AudienceSelector",["Arbiter","AudienceSelectorTags","CSS","CustomPrivacyOption","DOM","DynamicIconSelector","PrivacyConst","SelectorDeprecated"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AudienceSelectorTags'),i=b('CSS'),j=b('CustomPrivacyOption'),k=b('DOM'),l=b('DynamicIconSelector'),m=b('PrivacyConst'),n=b('SelectorDeprecated'),o={};n.subscribe('select',function(q,r){if(!i.hasClass(r.selector,'audienceSelector'))return;var s=n.getOptionValue(r.option);r.value=s;g.inform('AudienceSelector/changed',r);if(s==m.BaseValue.CUSTOM&&!i.hasClass(r.option,'noDialog')){n.toggle(r.selector);return false;}if(i.hasClass(r.selector,'dataTooltip')){var t=k.find(r.option,'.itemAnchor').getAttribute('data-tooltip');n.setButtonTooltip(r.selector,t||null);}if(!i.hasClass(r.option,'specialOption'))return;var u=k.find(r.option,'a').getAttribute('data-type');if(i.hasClass(r.option,'moreOption')){i.addClass(r.selector,u);i.addClass(r.selector,'showSecondaryOptions');return false;}else if(i.hasClass(r.option,'returnOption')){i.removeClass(r.selector,'showSecondaryOptions');i.removeClass(r.selector,'friendList');return false;}});var p={keepSynchronized:function(q,r){o[q]||(o[q]={});o[q][r.id]=r;},setHasTags:function(q){h.setHasTags(q);}};g.subscribe('CustomPrivacyOption/update',function(q,r){if(!i.hasClass(r.selector,'audienceSelector'))return;n.setSelected(r.selector,n.getOptionValue(r.option));l.swapIcon(r.selector);var s=i.hasClass(r.selector,'composerAudienceSelector');s&&n.setButtonLabel(r.selector,r.label);n.setButtonTooltip(r.selector,r.tooltip);g.inform('AudienceSelector/update',r);});g.subscribe(['AudienceSelector/changed','AudienceSelector/update'],function(event,q){var r=n.getOptionValue(q.option),s={};if(r==m.BaseValue.CUSTOM){if(event=='AudienceSelector/changed')return;s=j.getData(q.option.id);}for(var t in o){var u=o[t];if(u[q.selector.id]){g.inform('AudienceSelector/syncNonSelectorIcon',{category:t});for(var v in u){var w=u[v];if(!w||q.selector===w)continue;if(n.getValue(w)!==r){n.setSelected(w,r);l.swapIcon(w);}if(r==m.BaseValue.CUSTOM){var x=n.getOption(w,m.BaseValue.CUSTOM+'');if(x){j.setPrivacyData(x.id,s,r);n.setButtonTooltip(w,q.tooltip);}}}}}});e.exports=p;});
__d("legacy:AudienceSelector",["AudienceSelector"],function(a,b,c,d){b('AudienceSelector');},3);
__d("FriendListPrivacyOptions",["Arbiter","AsyncDialog","AsyncRequest","Dialog","DOMQuery","PageTransitions","Parent","SelectorDeprecated","$","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncDialog'),i=b('AsyncRequest'),j=b('Dialog'),k=b('DOMQuery'),l=b('PageTransitions'),m=b('Parent'),n=b('SelectorDeprecated'),o=b('$'),p=b('ge'),q=false,r=false,s=null,t={},u=function(w){if(!Object.keys(t).length)l.registerHandler(function(){t={};q=false;r=false;});var x=w.getAttribute('data-name');t[x]=w;n.listen(w,'select',function(y){var z=y.option,aa=k.find(z,'a.itemAnchor'),ba=aa.getAttribute('data-flid');if(!ba)return;var ca=aa.getAttribute('data-dynamic');if(ca&&q){v.showSmartListNux(z,ba);}else if(!ca&&r)v.showDumbListNux([ba]);});},v={listen:function(w,x,y){var z=p(w);if(!z)return;var aa=m.byClass(z,'audienceSelector');if(aa){u(aa);q=x;r=y;}},showSmartListNux:function(w,x){w=o(w);new i('/ajax/friends/lists/smart_list_publish_nux.php').setData({option_id:w.id,flid:x}).send();q=false;},setContextualDialog:function(w,x){x=o(x);var y=m.byClass(x,'audienceSelector');if(y){w.setContext(y);w.show();var z=g.subscribe('composer/publish',function(){w.hide();});w.subscribe('hide',function(){z.unsubscribe();});}},showDumbListNux:function(w){h.send(new i('/ajax/friends/lists/dumb_list_publish_nux.php').setData({flids:w}));r=false;},showBothListsNux:function(w,x){s=o(w);v.showDumbListNux(x);},setDialogX:function(w){if(!s)return;w.subscribe('hide',function(){v.showSmartListNux(s);s=null;});},setDialog:function(){if(!s)return;var w=j.getCurrent();if(w)w.setCloseHandler(function(){v.showSmartListNux(s);s=null;});}};e.exports=v;});
__d("FriendsMinusAcquaintancesPrivacyOption",["BasePrivacyOption","Class","PrivacyConst","copyProperties","fbt","tx"],function(a,b,c,d,e,f){var g=b('BasePrivacyOption'),h=b('Class'),i=b('PrivacyConst'),j=i.FriendsValue,k=b('copyProperties'),l=b('fbt'),m=b('tx');function n(o,p,q){this._hasRestricted=p;this.parent.construct(this,o,q);}h.extend(n,g);k(n.prototype,{_getChangedData:function(){return {hasEvent:this._hasEvent,tags:this._taggedIDs,privacy:j.FRIENDS_MINUS_ACQUAINTANCES};},_recalculateTooltipAndLabel:function(){var o=this._hasEvent,p=this._tags.length,q=this._tooltip,r=this._label;if(o){if(p>1||this._alreadyHasTags()){this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f; \u041a\u0440\u043e\u043c\u0435: \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445, \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f; \u041a\u0440\u043e\u043c\u0435: \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445";}else if(p==1){this._tooltip=this._hasRestricted?m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f; \u041a\u0440\u043e\u043c\u0435: \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445, \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445",{user:this._tags[0]}):m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f; \u041a\u0440\u043e\u043c\u0435: \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445",{user:this._tags[0]});}else this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f \u043a\u0440\u043e\u043c\u0435 \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445, \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f \u043a\u0440\u043e\u043c\u0435 \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445";}else if(p>0||this._alreadyHasTags()){var s="\u0434\u0440\u0443\u0437\u044c\u044f \u0432\u0441\u0435\u0445, \u043a\u0442\u043e \u0431\u044b\u043b \u043e\u0442\u043c\u0435\u0447\u0435\u043d",t=l._("{people who can see this}, {list of more people who can see this}",[l.param("people who can see this","\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f"),l.param("list of more people who can see this",s)]),u="\u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0435";if(this._hasRestricted)u=l._("{Name of Acquaintances friend list}, {restricted}",[l.param("Name of Acquaintances friend list",u),l.param("restricted","\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0435")]);this._tooltip=this._getCombinedSentence(t,u);}else{this._tooltip="\u0414\u0440\u0443\u0437\u044c\u044f, \u043a\u0440\u043e\u043c\u0435 \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0445";if(this._hasRestricted)this._tooltip="\u0414\u0440\u0443\u0437\u044c\u044f, \u043a\u0440\u043e\u043c\u0435: \u0417\u043d\u0430\u043a\u043e\u043c\u044b\u0435, \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u043e";}this._recalcLabel();return ((q!=this._tooltip)||(r!=this._label));},_getTagExpansionBehavior:function(){return i.TagExpansion.FRIENDS_OF_TAGGEES;}});e.exports=n;});
__d("FriendsPrivacyOption",["Arbiter","BasePrivacyOption","Class","PrivacyConst","SelectorDeprecated","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('BasePrivacyOption'),i=b('Class'),j=b('PrivacyConst'),k=b('SelectorDeprecated'),l=b('copyProperties'),m=b('tx');function n(o,p,q){this._hasRestricted=p;this.parent.construct(this,o,q);}i.extend(n,h);l(n.prototype,{_getChangedData:function(){return {hasEvent:this._hasEvent,tags:this._taggedIDs,privacy:j.FriendsValue.ALL_FRIENDS};},_eventTagChanged:function(){var o=this._getChangedData();o.privacy=k.getValue(this._selector);g.inform('EventTagged/changed',o);},_recalculateTooltipAndLabel:function(){var o=this._hasEvent,p=this._tags.length,q=this._tooltip,r=this._label;if(p>2){if(o){this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f, \u043a\u0440\u043e\u043c\u0435: \"\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445\"":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f";}else this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0432\u0441\u0435\u0445 \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u043b\u044e\u0434\u0435\u0439; \u041a\u0440\u043e\u043c\u0435: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0435":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0432\u0441\u0435\u0445 \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439";}else if(p==2){if(o){if(this._hasRestricted){this._tooltip="\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f, \u043a\u0440\u043e\u043c\u0435: \"\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445\"";}else this._tooltip="\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f";}else if(this._hasRestricted){this._tooltip=m._("\u0412\u0441\u0435 \u0432\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 {user2}; \u041a\u0440\u043e\u043c\u0435: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0435",{user:this._tags[0],user2:this._tags[1]});}else this._tooltip=m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 \u0434\u0440\u0443\u0437\u044c\u044f {user2}",{user:this._tags[0],user2:this._tags[1]});}else if(p==1){if(o){if(this._hasRestricted){this._tooltip=m._("\u042d\u0442\u043e \u0432\u0438\u0434\u044f\u0442 \u0432\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f, \u043a\u0440\u043e\u043c\u0435: \"\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445\"",{user:this._tags[0]});}else this._tooltip=m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f, \u0434\u0440\u0443\u0437\u044c\u044f {user} \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f",{user:this._tags[0]});}else if(this._hasRestricted){this._tooltip=m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0434\u0440\u0443\u0437\u044c\u044f {user}; \u041a\u0440\u043e\u043c\u0435: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0435",{user:this._tags[0]});}else this._tooltip=m._("\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  {user}",{user:this._tags[0]});}else if(o){this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f, \u043a\u0440\u043e\u043c\u0435: \"\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445\"":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u0438 \u0433\u043e\u0441\u0442\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f";}else this._tooltip=this._hasRestricted?"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f; \u041a\u0440\u043e\u043c\u0435: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0435":"\u0412\u0430\u0448\u0438 \u0434\u0440\u0443\u0437\u044c\u044f";this._recalcLabel();return (q!=this._tooltip)||(r!=this._label);},_getTagExpansionBehavior:function(){return j.TagExpansion.FRIENDS_OF_TAGGEES;}});e.exports=n;});
__d("MetaComposerEdDialog",["Animation","Arbiter","ARIA","AsyncRequest","copyProperties","CSS","DOM","Ease","ge","Parent","SelectorDeprecated","Vector"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('ARIA'),j=b('AsyncRequest'),k=b('copyProperties'),l=b('CSS'),m=b('DOM'),n=b('Ease'),o=b('ge'),p=b('Parent'),q=b('SelectorDeprecated'),r=b('Vector'),s=null;function t(u){this._dialog=u.dialog;this.config=u;this._init();}t.init=function(u){if(s){s.config.show_audience=u.show_audience;u.dialog.destroy();return;}s=new t(u);};k(t.prototype,{_init:function(){h.subscribe('ComposerXStatusAttachment/ready',function(){if(this.config.show_audience){this._sendEducationRequest({},'/ajax/composer/audience/education',this._handlerCustomDuration.bind(this,6000));this.config.show_audience=false;}}.bind(this));if(this.config.show_sticky)h.subscribe('composer/mutate',function(u,v){this._sendEducationRequest({sticky_num:this.config.n_sticky_shown},'/ajax/composer/audience/sticky_education');}.bind(this));if(this.config.show_event_tags)if(this.config.n_event_tag_shown===0){h.subscribe('EventTagged/changed',function(u,v){this._sendEducationRequest({selector:'div.fbComposerAudienceTourContext',privacy:v.privacy,event_tag_num:this.config.n_event_tag_shown},'/ajax/events/tagging/user_education');}.bind(this));h.subscribe(['composer/publish','composer/reset'],function(){var u=o("event_tagging_tag_expansion_NUX");u&&l.hide(u);}.bind(this));}else h.subscribe('EventTagged/changed',function(u,v){this._sendEducationRequest({ids:v.tags,from:'AtTagger',hasEvent:v.hasEvent,type:v.privacy,tag_num:this.config.n_tag_shown,event_tag_num:this.config.n_event_tag_shown},'ajax/composer/audience/tag_education',this._handler.bind(this));}.bind(this));if(this.config.show_tags)h.subscribe('SelectedPrivacyOption/changed',function(u,v){this._sendEducationRequest({ids:v.tags,from:'WithTagger',hasEvent:v.hasEvent,type:v.privacy,tag_num:this.config.n_tag_shown,event_tag_num:this.config.n_event_tag_shown},'/ajax/composer/audience/tag_education',this._handler.bind(this));}.bind(this));q.subscribe('open',this._killAnim.bind(this));},_sendEducationRequest:function(u,v,w){if(!this._updateDialogContext())return;this._async&&this._async.abort();this._async=new j(v);this._async.setData(u).setHandler(w).send();},_updateDialogContext:function(){var u=m.scry(document.body,'div.composerAudienceWrapper'),v,w;for(var x=0;x<u.length;x++){v=u[x];w=r.getElementPosition(v);if(v&&w.x>0&&w.y>0){this._dialog.setContext(v);return true;}}return false;},_handler:function(u){this._handlerCustomDuration(1500,u);},_handlerCustomDuration:function(u,v){var w=v.payload;if(!w||!this._updateDialogContext())return;var x=this._dialog.getContent().firstChild;m.setContent(x,w);i.announce(m.getText(x));this._dialog.show();var y=p.byClass(x,'metaComposerUserEd');if(this._anim){this._anim.stop();this._anim=new g(y);}else this._anim=new g(y).from('opacity',0);this._anim.to('opacity',1).ease(n.sineOut).checkpoint().duration(u).checkpoint().to('opacity',0).ease(n.sineOut).checkpoint().ondone(this._killAnim.bind(this)).go();},_killAnim:function(u,v){if(this._anim){this._dialog.hide();this._anim.stop();this._anim=null;}}});e.exports=t;});
__d("OnlyMePrivacyOption",["BasePrivacyOption","copyProperties","Class","PrivacyConst","tx"],function(a,b,c,d,e,f){var g=b('BasePrivacyOption'),h=b('copyProperties'),i=b('Class'),j=b('PrivacyConst'),k=b('tx');function l(m,n){this.parent.construct(this,m,n);}i.extend(l,g);h(l.prototype,{_getChangedData:function(){return {hasEvent:this._hasEvent,tags:this._taggedIDs,privacy:j.FriendsValue.SELF};},_getIncludedAudience:function(){if(this._isSharedAlbum()){return this._elem.getAttribute('data-label');}else return "\u0422\u043e\u043b\u044c\u043a\u043e \u044f";},_getTagExpansionBehavior:function(){if(this._isSharedAlbum()){return j.TagExpansion.NONE;}else return j.TagExpansion.TAGGEES;},_recalculateTooltipAndLabel:function(){var m=this._tooltip,n=this._label,o=this._getTagExpansionText();this._tooltip=o?o:this._getIncludedAudience();this._recalcLabel();return (m!=this._tooltip)||(n!=this._label);}});e.exports=l;});
__d("legacy:DynamicIconSelector",["DynamicIconSelector"],function(a,b,c,d){a.DynamicIconSelector=b('DynamicIconSelector');},3);
__d("MentionsInputMatchers",[],function(a,b,c,d,e,f){var g=['@','\\uff20','+','\\uff0b'].join(''),h='.,*?$|#{}()\\^\\-\\[\\]\\\\\/!%&\'"~=<>_:;',i='\\b[A-Z][^ A-Z'+h+']',j='([^'+g+h+']|['+h+'][^ '+h+'])',k='(?:^|\\s)(?:['+g+']('+j+'{0,20}))',l='(?:(?:^|[^#])('+i+'+)|'+k+')',m='(?:'+i+'{4,})',n='#\\uFF03',o={trigger:new RegExp('['+g+']$'),hashtagTrigger:new RegExp('['+n+']'),mainMatcher:new RegExp(k+'$'),autoMatcher:new RegExp(l+'$'),userMatcher:new RegExp(m+'$')};e.exports=o;});
__d("MentionsInput",["function-extensions","Arbiter","ArbiterMixin","Bootloader","CSS","DataStore","DOM","Event","HTML","Input","InputSelection","Keys","MentionsInputMatchers","Parent","Style","TokenizeUtil","UserAgent","copyProperties","htmlize","mixin","removeFromArray","repeatString"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Bootloader'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('Event'),n=b('HTML'),o=b('Input'),p=b('InputSelection'),q=b('Keys'),r=b('MentionsInputMatchers'),s=b('Parent'),t=b('Style'),u=b('TokenizeUtil'),v=b('UserAgent'),w=b('copyProperties'),x=b('htmlize'),y=b('mixin'),z=b('removeFromArray'),aa=b('repeatString'),ba='\uFEFF',ca=new RegExp(ba,'g'),da=function(na){return na+ba;},ea='\uFFFD',fa=/@+\[[0-9]+\:([^\]]|\\\])*\]+/g,ga=/[\\\]:]/g;function ha(na,oa){return na.replace(oa,aa(' ',oa.length));}function ia(na,oa){return na.substring(0,oa)+na.substring(oa+1);}var ja=y(h);for(var ka in ja)if(ja.hasOwnProperty(ka)&&ka!=="_metaprototype")ma[ka]=ja[ka];var la=ja===null?null:ja.prototype;ma.prototype=Object.create(la);ma.prototype.constructor=ma;ma.__superConstructor__=ja;function ma(na,oa,pa,qa,ra,sa){k.set(na,'MentionsInput',this);this._root=na;this._typeahead=oa;this._input=pa;var ta=null,ua=this.init.bind(this,qa,ra,sa);try{ta=document.activeElement===this._input;}catch(va){}if(ta){ua.defer();}else var wa=m.listen(this._input,'focus',function(){ua.defer();wa.remove();});this._hasHashtags=qa.hashtags;this._hashtags=[];}ma.prototype.init=function(na,oa,pa){if(this._initialized)return;this._initialized=true;this._highlighter=l.find(this._root,'.highlighter');this._highlighterInner=this._highlighter.firstChild;this._highlighterContent=l.find(this._root,'.highlighterContent');this._hiddenInput=l.find(this._root,'.mentionsHidden');this._placeholder=this._input.getAttribute('placeholder')||'';this._maxMentions=na.max||6;this._metrics=pa;if(!this._hiddenInput.name){var qa=this._input.name;this._input.name=qa+'_text';this._hiddenInput.name=qa;}this._initEvents();this._initTypeahead();this.reset(oa);this.inform('init',null,g.BEHAVIOR_STATE);};ma.prototype.reset=function(na){if(!this._initialized)return;this._mentioned={};this._orderedUIDs=[];this._numMentioned=0;this._filterData=null;this._hiddenInput&&(this._hiddenInput.value='');this._highlighterContent&&l.empty(this._highlighterContent);this._highlighterAuxContent&&l.remove(this._highlighterAuxContent);this._highlighterAuxContent=null;o.setPlaceholder(this._input,this._placeholder);t.set(this._typeahead.getElement(),'height','auto');var oa=na&&na.value||'',pa=na&&na.mentions;if(pa&&pa.length){var qa=[];pa.forEach(function(ra){qa.push(ra.offset+ra.length);delete ra.offset;delete ra.length;this._addToken(ra);},this);qa.reverse().forEach(function(ra){oa=oa.substring(0,ra)+ba+oa.substring(ra);});}o.setValue(this._input,oa);this._updateTypeahead();this._updateWidth();this._update();};ma.prototype.getValue=function(){return this._getMarkedValue().replace(ca,'');};ma.prototype._getMarkedValue=function(){return o.getValue(this._input);};ma.prototype.getRawValue=function(){this._update();return o.getValue(this._hiddenInput);};ma.prototype.checkValue=function(){var na=this._typeahead.getCore().getValue();if(r.trigger.exec(na)||na==='')this.inform('sessionEnd',{});};ma.prototype.getTypeahead=function(){return this._typeahead;};ma.prototype._initEvents=function(){var na=this._update.bind(this);m.listen(this._input,{input:na,keyup:na,change:na,blur:this._handleBlur.bind(this),focus:this._handleFocus.bind(this),keydown:this._handleKeydown.bind(this)});if(this._metrics){this._metrics._reset();this._metrics.bindSessionStart(this._typeahead,'render',true);this._metrics.bindSessionEnd(this._typeahead.getView(),'select',true);this._metrics.bindSessionEnd(this,'sessionEnd',false);m.listen(this._input,'keyup',function(event){this.checkValue.bind(this).defer();}.bind(this));}};ma.prototype._initTypeahead=function(){this._typeahead.subscribe('select',function(sa,ta){var ua=ta.selected;this._addToken({uid:ua.uid,text:ua.text,type:ua.type,weakreference:ua.weak_reference});this.updateValue();}.bind(this));var na=this._input,oa=null;function pa(){if(oa===null){oa=o.getSubmitOnEnter(na);o.setSubmitOnEnter(na,false);}}function qa(){if(oa!==null){o.setSubmitOnEnter(na,oa);oa=null;}}this._typeahead.subscribe('reset',qa);this._typeahead.subscribe('render',pa);this._typeahead.subscribe('highlight',function(sa,ta){ta.index>=0?pa():qa();});this._typeahead.subscribe('query',function(){this._filterData=null;}.bind(this));var ra=this._typeahead.getCore();ra.suffix=ba;this._handleFocus();};ma.prototype._handleBlur=function(){if(this._filterToken){this._filterToken.remove();this._filterToken=null;}};ma.prototype._handleFocus=function(){if(!this._filterToken)this._filterToken=this._typeahead.getData().addFilter(this._filterResults.bind(this));this._updateWidth();};ma.prototype._handleKeydown=function(event){var na=event.keyCode;if(na==q.BACKSPACE||na==q.DELETE)this._handleBackspaceAndDelete(event,na);if(na==q.LEFT||na==q.RIGHT)setTimeout(this._handleLeftAndRight.bind(this,na),10);};ma.prototype._handleLeftAndRight=function(na){var oa=this._getMarkedValue(),pa=p.get(this._input),qa=pa.start,ra=pa.end,sa=na==q.LEFT,ta=na==q.RIGHT;if(qa==ra){var ua=sa?-1:1;if(oa.charAt(qa)==ba)p.set(this._input,qa+ua);}else if(sa&&oa.charAt(qa)==ba){p.set(this._input,qa-1,ra);}else if(sa&&oa.charAt(ra)==ba){p.set(this._input,qa,ra-1);}else if(ta&&oa.charAt(ra)==ba){p.set(this._input,qa,ra+1);}else if(ta&&oa.charAt(qa)==ba)p.set(this._input,qa+1,ra);};ma.prototype._handleBackspaceAndDelete=function(event,na){var oa=p.get(this._input),pa=false;if(oa.start!==oa.end)if(this._offsetIsInsideMention(oa.start+1)&&this._offsetIsInsideMention(oa.end)){pa=(na===q.BACKSPACE);}else return;var qa=na===q.DELETE?1:-1,ra=qa+(pa?oa.end:oa.start),sa=this._getMarkedValue(),ta=sa;for(var ua=0;ua<this._orderedUIDs.length;++ua){var va=this._mentioned[this._orderedUIDs[ua]],wa=va.text,xa=da(wa),ya=ta.indexOf(xa),za=ya+xa.length;if(ra<ya||ra>=za){ta=ha(ta,xa);continue;}var ab,bb;if(va.type!='user'){ab=0;bb=[wa];}else{ab=xa.substring(0,ra-ya).split(' ').length-1;bb=wa.split(' ');}var cb=bb.splice(ab,1)[0],db=bb.join(' '),eb=ab===0?ya:za-cb.length-1;if(db){va.text=db;db=da(db);}else this._removeToken(va.uid);var fb=sa.substring(0,ya)+db+sa.substring(za);o.setValue(this._input,fb);p.set(this._input,eb);this._update();event.kill();break;}};ma.prototype._offsetIsInsideMention=function(na){for(var oa=0;oa<this._offsets.length;oa++)if(na>this._offsets[oa][0]&&na<=this._offsets[oa][1])return true;return false;};ma.prototype._filterResults=function(na){if(this._filterData===null){var oa=p.get(this._input).start;if(this._offsetIsInsideMention(oa)){this._filterData={caretIsInsideMention:true};return false;}var pa=this._typeahead.getCore();this._filterData={value:pa.getValue(),rawValue:pa.getRawValue()};}if(this._filterData.caretIsInsideMention)return false;if(r.mainMatcher.test(this._filterData.rawValue))return true;if(na.type!='user')return false;if(na.disable_autosuggest)return false;if(r.userMatcher.test(this._filterData.value))return true;return u.isExactMatch(this._filterData.value,this._typeahead.getData().getTextToIndex(na));};ma.prototype._addToken=function(na){var oa=na.uid;if(!this._mentioned.hasOwnProperty(oa)){this._mentioned[oa]=na;this._orderedUIDs.push(oa);this._numMentioned++;this._updateTypeahead();}};ma.prototype._removeToken=function(na){if(this._mentioned.hasOwnProperty(na)){delete this._mentioned[na];z(this._orderedUIDs,na);this._numMentioned--;this._updateTypeahead();}};ma.prototype._update=function(){var na=this._getMarkedValue();if(na==this._value)return;this._value=na;this._updateMentions();this._updateDirection.bind(this).defer();this.updateValue();};ma.prototype._updateMentions=function(){this._offsets=[];var na=this._getMarkedValue(),oa=na;for(var pa=0;pa<this._orderedUIDs.length;++pa){var qa=this._orderedUIDs[pa],ra=da(this._mentioned[qa].text),sa=oa.indexOf(ra);if(sa==-1)this._removeToken(qa);oa=ha(oa,ra);this._offsets.push([sa,sa+ra.length]);}var ta=na;while((sa=oa.indexOf(ba))>-1){ta=ia(ta,sa);oa=ia(oa,sa);}if(na!==ta){var ua=p.get(this._input);o.setValue(this._input,ta);p.set(this._input,ua.start);this._value=ta;}};ma.prototype._renderHashtags=function(na){if(!this._hasHashtags)return x(na);if(!this._hashtagParser){if(r.hashtagTrigger.exec(na))this.bootloadHashtagParser();if(!this._hashtagParser)return x(na);}this._hashtags=this._hashtagParser.parse(na);var oa=[],pa=0;for(var qa=0;qa<this._hashtags.length;qa++){var ra=this._hashtags[qa];oa.push(x(na.substring(pa,ra.rawOffset)),'<b>',ra.marker,ra.tag,'</b>');pa=ra.rawOffset+ra.marker.length+ra.tag.length;}oa.push(x(na.substring(pa)));return oa.join('');};ma.prototype.updateValue=function(){var na=this._value=this._getMarkedValue(),oa=this._orderedUIDs,pa=na.replace(fa,ea);for(var qa=0;qa<oa.length;++qa){var ra='@['+oa[qa]+':]',sa=da(this._mentioned[oa[qa]].text);pa=pa.replace(sa,ra);na=na.replace(sa,ra);}var ta=this._renderHashtags(na);for(var qa=0;qa<oa.length;++qa){var ua=oa[qa],va=this._mentioned[ua],wa=va.text,xa=va.weakreference?'<b class="weak">':'<b>';ta=ta.replace('@['+ua+':]',xa+x(da(wa))+'</b>');wa=wa.replace(ga,function(ya){return '\\'+ya;});pa=pa.replace('@['+ua+':]','@['+ua+':'+wa+']');}if(v.ie())ta=ta.replace(/ /g,'&nbsp;<wbr/>');l.setContent(this._highlighterContent,n(ta));this._hiddenInput.value=pa;this._updateHighlighter();this._updateHeight();};ma.prototype._updateDirection=function(){var na=t.get(this._input,'direction');if(na==this._dir)return;this._dir=na;t.set(this._highlighter,'direction',na);if(na=='rtl'){t.set(this._highlighter,'text-align','right');}else t.set(this._highlighter,'text-align','left');};ma.prototype._updateWidth=function(){var na=t.getFloat.curry(this._input),oa=this._input.offsetWidth-na('paddingLeft')-na('paddingRight')-na('borderLeftWidth')-na('borderRightWidth');if(v.firefox())oa-=2;if(v.ie()<=7){oa-=t.getFloat(this._highlighterInner,'paddingLeft');this._highlighter.style.zoom=1;}this._highlighterInner.style.width=Math.max(oa,0)+'px';};ma.prototype._updateHeight=function(){if(this._highlighterAuxContent){var na=this._highlighter.offsetHeight,oa=this._typeahead.getElement();if(na>oa.offsetHeight){t.set(oa,'height',na+'px');g.inform('reflow');}}};ma.prototype._updateTypeahead=function(){var na=this._typeahead.getCore(),oa=null;if(!this._maxMentions||this._numMentioned<this._maxMentions)oa=r.autoMatcher;na.matcher=oa;na.setExclusions(this._orderedUIDs);this.inform('update',{mentioned:this._mentioned});};ma.prototype.setPlaceholder=function(na){this._placeholder=na;if(!this.hasAuxContent())o.setPlaceholder(this._input,na);};ma.prototype._updateHighlighter=function(){if(this._highlighterContent)j.conditionShow(this._highlighterContent,this._numMentioned>0||this.hasAuxContent()||this._hashtags.length);};ma.prototype.setAuxContent=function(na){if(this._highlighterContent){if(!this._highlighterAuxContent){this._highlighterAuxContent=l.create('span',{className:'highlighterAuxContent'});l.insertAfter(this._highlighterContent,this._highlighterAuxContent);}l.setContent(this._highlighterAuxContent,na);if(na){o.setPlaceholder(this._input,'');}else o.setPlaceholder(this._input,this._placeholder);this._updateHighlighter();this._updateHeight();}};ma.prototype.hasAuxContent=function(){var na=this.getAuxContentRoot();return na&&na.innerHTML.length>0;};ma.prototype.getAuxContentRoot=function(){return this._highlighterAuxContent;};ma.prototype.addMention=function(na){var oa=this._getMarkedValue();if(oa!=='')oa+=' ';o.setValue(this._input,oa+da(na.text)+' ');this._addToken(na);this._update();};ma.prototype.getMentions=function(){return this._mentioned;};ma.prototype.bootloadHashtagParser=function(){if(!this._hashtagParser)i.loadModules(['HashtagParser'],function(na){this._hashtagParser=na;if(this._initialized)this._update();}.bind(this));};ma.getInstance=function(na){var oa=s.byClass(na,'uiMentionsInput');return oa?k.get(oa,'MentionsInput'):null;};e.exports=ma;});
__d("MentionsTypeaheadAreaView",["ContextualTypeaheadView","Parent"],function(a,b,c,d,e,f){var g=b('ContextualTypeaheadView'),h=b('Parent');for(var i in g)if(g.hasOwnProperty(i)&&i!=="_metaprototype")k[i]=g[i];var j=g===null?null:g.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=g;function k(){if(g!==null)g.apply(this,arguments);}k.prototype.getContext=function(){return h.byClass(this.element,'uiMentionsInput');};e.exports=k;});
__d("legacy:MentionsInput",["MentionsInput"],function(a,b,c,d){a.MentionsInput=b('MentionsInput');},3);
__d("TypeaheadAreaCore",["InputSelection","TypeaheadCore","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('InputSelection'),h=b('TypeaheadCore'),i=b('copyProperties'),j=b('emptyFunction');for(var k in h)if(h.hasOwnProperty(k)&&k!=="_metaprototype")m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){h.call(this,n);this.matcher=new RegExp(this.matcher+'$');this.preventFocusChangeOnTab=true;}m.prototype.select=function(n){l.select.call(this,n);var o=this.element.value,p=this.prefix+n.text+this.suffix;this.expandBounds(o,p);var q=o.substring(0,this.start),r=o.substring(this.end);this.element.value=q+p+r;g.set(this.element,q.length+p.length);};m.prototype.expandBounds=function(n,o){n=n.toLowerCase();o=o.toLowerCase();var p,q,r,s,t=/\s/;q=n.substring(this.start,this.end);r=o.indexOf(q);p=this.start;while(p>=0&&r>=0){s=n.charAt(p-1);if(!s||t.test(s))this.start=p;q=s+q;r=o.indexOf(q);p--;}q=n.substring(this.start,this.end);r=o.indexOf(q);p=this.end;while(p<=n.length&&r>=0){s=n.charAt(p);if(!s||t.test(s))this.end=p;q=q+s;r=o.indexOf(q);p++;}};m.prototype.getRawValue=function(){var n=g.get(this.element).start||0;return l.getValue.call(this).substring(0,n);};m.prototype.getValue=function(){var n=this.matcher&&this.matcher.exec(this.getRawValue());if(!n)return '';var o=n[0],p=n.index+o.length;o=o.replace(/^\s/,'');var q=o.length;o=o.replace(/\s$/,'');var r=q-o.length;this.start=p-q;this.end=p+r;return n[2]||n[1]||n[0];};i(m.prototype,{prefix:'',suffix:', ',matcher:"\\b[^,]*",click:j});e.exports=m;});
__d("TypeaheadMetrics",["AsyncRequest","Event","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Event'),i=b('copyProperties'),j=b('emptyFunction');function k(l){this.extraData={};i(this,l);}k.prototype.init=function(l){this.init=j;this.core=l.getCore();this.view=l.getView();this.data=l.getData();this.stats={};this.sessionActive=false;this._sessionStartEvents=[];this._sessionEndEvents=[];this._reset();this.initEvents();};k.prototype._reset=function(){this.stats={};this.avgStats={};this.sessionActive=false;this.results=null;this.sid=Math.floor(Date.now()*Math.random());this.data.setQueryData({sid:this.sid});};k.prototype.recordSelect=function(l){var m=l.selected;if(m.uid==null){this.recordStat('selected_id','SELECT_NULL');}else this.recordStat('selected_id',m.uid);this.recordStat('selected_type',m.type);this.recordStat('selected_position',l.index);this.recordStat('selected_with_mouse',l.clicked?1:0);this.recordStat('selected_query',l.query);this._sessionEnd();};k.prototype.bindSessionStart=function(l,event,m){if(m)for(var n=0;n<this._sessionStartEvents.length;++n){var o=this._sessionStartEvents[n];o.obj.unsubscribe(o.token);}this._sessionStartEvents.push({obj:l,token:l.subscribe(event,function(p,q){this._sessionStart();}.bind(this))});};k.prototype.bindSessionEnd=function(l,event,m){if(m)for(var n=0;n<this._sessionEndEvents.length;++n){var o=this._sessionEndEvents[n];o.obj.unsubscribe(o.token);}this._sessionEndEvents.push({obj:l,token:l.subscribe(event,function(p,q){this._sessionEnd();}.bind(this))});};k.prototype.initEvents=function(){this.bindSessionStart(this.core,'focus',false);this.bindSessionEnd(this.core,'blur',false);this.view.subscribe('select',function(l,m){this.recordSelect(m);}.bind(this));this.bindSessionEnd(this.view,'select',false);this.view.subscribe('render',function(l,m){this.results=m;}.bind(this));this.data.subscribe('beforeQuery',function(l,m){if(!m.value)return;this.query=m.value;this.recordCountStat('num_queries');}.bind(this));this.data.subscribe('beforeFetch',function(l,m){if(m.fetch_context.bootstrap){this.bootstrapBegin=Date.now();}else m.fetch_context.queryBegin=Date.now();}.bind(this));this.data.subscribe('fetchComplete',function(l,m){if(m.fetch_context.bootstrap){this.recordAvgStat('bootstrap_latency',Date.now()-this.bootstrapBegin);var n={};m.response.payload.entries.forEach(function(o){if(!n[o.type]){n[o.type]=1;}else n[o.type]++;});this.recordStat('bootstrap_response_types',n);this.bootstrapped=true;}else{if('filtered_count' in m.response.payload)this.recordStat('filtered_count',m.response.payload.filtered_count);this.recordAvgStat('avg_query_latency',Date.now()-m.fetch_context.queryBegin);}}.bind(this));this.data.subscribe('dirty',function(l,m){this.bootstrapped=false;});};k.prototype._sessionStart=function(){if(this.sessionActive)return;this.sessionActive=true;};k.prototype._sessionEnd=function(){if(!this.sessionActive)return;this.sessionActive=false;this.submit();this._reset();};k.prototype.recordStat=function(l,m){this.stats[l]=m;};k.prototype.recordCountStat=function(l){var m=this.stats[l];this.stats[l]=m?m+1:1;};k.prototype.recordAvgStat=function(l,m){if(this.avgStats[l]){this.avgStats[l][0]+=m;++this.avgStats[l][1];}else this.avgStats[l]=[m,1];};k.prototype.hasStats=function(){return !!Object.keys(this.stats).length;};k.prototype.submit=function(){if(this.hasStats()){i(this.stats,this.extraData);if(this.results){var l=(this.results).map(function(o,p){return o.uid;});this.recordStat('candidate_results',JSON.stringify(l));}if(this.query)this.recordStat('query',this.query);if(this.sid)this.recordStat('sid',this.sid);if(this.bootstrapped)this.recordStat('bootstrapped',1);for(var m in this.avgStats){var n=this.avgStats[m];this.stats[m]=n[0]/n[1];}new g().setURI(this.endPoint).setMethod('POST').setData({stats:this.stats}).send();this._reset();}};k.register=function(l,m,n){if(document.activeElement===l){m.init(n);}else var o=h.listen(l,'focus',function(){m.init(n);o.remove();});};i(k.prototype,{endPoint:'/ajax/typeahead/record_basic_metrics.php'});e.exports=k;});
__d("TypeaheadHoistFriends",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._typeahead=i;}h.prototype.enable=function(){var i=this._typeahead.getView();this._subscription=i.subscribe('beforeRender',function(j,k){var l=[],m=[],n=[];for(var o=0;o<k.results.length;++o){var p=k.results[o];if(p.type=='header'){n=n.concat(m,l);n.push(p);m=[];l=[];}else if(p.type=='user'&&p.bootstrapped){m.push(p);}else l.push(p);}k.results=n.concat(m,l);});};h.prototype.disable=function(){this._typeahead.getView().unsubscribe(this._subscription);this._subscription=null;};g(h.prototype,{_subscription:null});e.exports=h;});
__d("legacy:HoistFriendsTypeaheadBehavior",["TypeaheadHoistFriends"],function(a,b,c,d){var e=b('TypeaheadHoistFriends');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.hoistFriends=function(f){f.enableBehavior(e);};},3);